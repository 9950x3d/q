
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brainrot Stealing V33 (Remake & New Pet)</title>
    <style>
        :root {
            --bg-color: #0d0d0d;
            --text-color: white;
            --panel-bg: #222;
            --accent-color: #ffcc00;
        }

        body {
            font-family: 'Comic Sans MS', 'Malgun Gothic', 'Microsoft YaHei', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            text-align: center;
            margin: 0;
            padding: 10px;
            user-select: none;
            min-height: 100vh;
            overflow-x: hidden;
            overflow-y: auto; 
            transition: background 0.5s ease;
        }

        body.pc-mode { zoom: 0.9; }
        body.mobile-mode { zoom: 1.0; }

        /* ë°°ê²½ ìŠ¤íƒ€ì¼ */
        body.bg-secret { background: linear-gradient(180deg, #000, #fff, #000) !important; background-attachment: fixed !important; color: #00ff00 !important; }
        body.bg-og { background: linear-gradient(180deg, #f7e500, #C9BA00, #988D00, #716900, #000) !important; background-attachment: fixed !important; }
        body.bg-rainbow { background: linear-gradient(45deg, #ff0000, #ff7f00, #ffff00, #00ff00, #00ff00, #4b0082, #9400d3) !important; background-size: 400% 400%; animation: rainbowBg 10s ease infinite; background-attachment: fixed !important; }
        @keyframes rainbowBg { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        h1 { color: var(--accent-color); text-shadow: 2px 2px 0px #000; font-size: 2.2rem; margin-bottom: 15px; margin-top: 40px; cursor: pointer; transition: 0.2s; }
        h1:active { transform: scale(0.95); }

        /* ì„¤ì • ë²„íŠ¼ */
        .btn-settings-open { position: absolute; top: 15px; right: 15px; background: #333; color: white; border: 2px solid #555; padding: 8px 12px; border-radius: 10px; cursor: pointer; font-size: 1rem; z-index: 100; font-weight: bold; }
        
        /* í–‰ìš´ í¬ì…˜ UI */
        #luckStatus { position: absolute; top: 15px; left: 15px; background: rgba(0,0,0,0.8); border: 2px solid #00ff00; padding: 8px 15px; border-radius: 20px; color: #00ff00; font-weight: bold; display: none; z-index: 100; box-shadow: 0 0 10px #00ff00; }

        /* ëª¨ë‹¬ ê³µí†µ */
        #settingsModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2000; justify-content: center; align-items: center; }
        .settings-content { background: #222; width: 90%; max-width: 450px; padding: 20px; border-radius: 15px; border: 3px solid #fff; text-align: center; box-shadow: 0 0 20px rgba(255,255,255,0.2); color: white; max-height: 90vh; overflow-y: auto; }
        .settings-title { font-size: 1.5rem; font-weight: bold; margin-bottom: 20px; border-bottom: 2px solid #555; padding-bottom: 10px; }
        .settings-section { margin-bottom: 20px; }
        .settings-label { font-size: 1rem; color: #aaa; margin-bottom: 5px; display: block; }
        .btn-group { display: flex; justify-content: center; gap: 5px; flex-wrap: wrap; }
        
        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .setting-btn { background: #333; color: white; border: 1px solid #555; padding: 8px 12px; border-radius: 5px; cursor: pointer; }
        .setting-btn.active { background: #007bff; border-color: #00bfff; }
        .btn-close { background: #d9534f; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 1rem; margin-top: 10px; }
        .btn-save { background: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; margin: 5px; }
        .btn-reset { background: #d9534f; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; margin: 5px; }
        
        /* ì½”ë“œ ì…ë ¥ì°½ */
        .code-input-group { display: flex; gap: 5px; justify-content: center; margin-top: 10px; }
        #codeInput { padding: 8px; border-radius: 5px; border: 1px solid #555; background: #111; color: white; width: 60%; }
        #btnRedeem { padding: 8px 15px; border-radius: 5px; border: none; background: #007bff; color: white; cursor: pointer; font-weight: bold; }

        /* ìƒ‰ìƒ/í…Œë§ˆ ë²„íŠ¼ */
        .color-btn { width: 30px; height: 30px; border-radius: 50%; border: 2px solid #fff; cursor: pointer; }
        .special-bg-btn { background: #444; color: #888; border: 1px solid #555; padding: 8px 12px; border-radius: 5px; cursor: not-allowed; width: 100%; margin-bottom: 5px; font-size: 0.9rem; transition: all 0.3s; }
        .special-bg-btn.unlocked { background: #007bff; color: white; border-color: #00bfff; cursor: pointer; box-shadow: 0 0 10px #007bff; }

        /* --- [ë¦¬ë©”ì´í¬ëœ í•µ ë©”ë‰´ ìŠ¤íƒ€ì¼] --- */
        #hackMenu { 
            display: none; 
            position: fixed; 
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%); 
            width: 350px; 
            background-color: rgba(10, 15, 10, 0.98); 
            border: 2px solid #33ff00; 
            border-radius: 5px; 
            padding: 0; 
            z-index: 3000; 
            box-shadow: 0 0 40px rgba(51, 255, 0, 0.4), inset 0 0 20px rgba(51, 255, 0, 0.1); 
            font-family: 'Consolas', 'Courier New', monospace; 
            text-align: left; 
            color: #33ff00; 
        }
        .hack-header {
            background: #0f1a0f;
            color: #33ff00;
            padding: 8px 15px;
            font-weight: bold;
            border-bottom: 1px solid #33ff00;
            display: flex;
            justify-content: space-between;
            align-items: center;
            letter-spacing: 1px;
        }
        .hack-body {
            padding: 15px;
        }
        .hack-row { margin-bottom: 15px; }
        .hack-label { font-size: 0.8rem; opacity: 0.8; display: block; margin-bottom: 4px; }
        .hack-select { 
            width: 100%; 
            background: #000; 
            color: #33ff00; 
            border: 1px solid #33ff00; 
            padding: 6px; 
            font-family: inherit; 
            outline: none;
        }
        .hack-btn { 
            width: 100%; 
            background: #002200; 
            color: #33ff00; 
            border: 1px solid #33ff00; 
            padding: 10px; 
            margin-top: 8px; 
            cursor: pointer; 
            font-weight: bold; 
            font-family: inherit;
            transition: all 0.2s;
            text-transform: uppercase;
        }
        .hack-btn:hover {
            background: #33ff00;
            color: #000;
            box-shadow: 0 0 15px #33ff00;
        }
        .hack-close { 
            color: #ff3333; 
            cursor: pointer; 
            font-weight: bold; 
            font-size: 1.1rem;
        }
        .hack-close:hover { text-shadow: 0 0 5px #ff3333; }

        /* ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        .control-panel { background: var(--panel-bg); border: 2px solid #555; border-radius: 15px; padding: 10px; margin: 10px auto; max-width: 550px; display: flex; flex-direction: column; gap: 8px; align-items: center; }
        .auto-btn { width: 100%; padding: 10px; font-size: 1.1rem; border-radius: 10px; border: none; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .auto-btn.off { background: #d9534f; color: white; }
        .auto-btn.on { background: #28a745; color: white; box-shadow: 0 0 15px #28a745; }
        .autosell-container { width: 100%; display: flex; flex-wrap: wrap; justify-content: center; gap: 5px; background: rgba(0,0,0,0.5); padding: 8px; border-radius: 10px; }
        .filter-btn { padding: 4px 8px; border: 2px solid #555; background: #333; color: #aaa; border-radius: 5px; cursor: pointer; font-size: 0.8rem; }
        .filter-btn.active { background: #d9534f; color: white; border-color: #ff0000; }
        
        /* í•©ì„± NPC ìŠ¤íƒ€ì¼ */
        .fusion-npc-container {
            cursor: pointer;
            transition: transform 0.2s;
            position: relative;
            background: linear-gradient(135deg, #222, #444);
            border: 2px solid #00ffff;
            border-radius: 15px;
            padding: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 95%;
            box-shadow: 0 0 15px rgba(0,255,255,0.3);
        }
        .fusion-npc-container:active { transform: scale(0.95); }
        .fusion-npc-img { width: 60px; height: 60px; object-fit: contain; filter: drop-shadow(0 0 5px white); }
        .fusion-text { font-size: 1.2rem; font-weight: bold; color: #00ffff; text-shadow: 0 0 5px #000; }

        /* ìƒíƒœì°½ */
        .stats-container { background-color: var(--panel-bg); padding: 10px; border-radius: 15px; display: inline-block; margin-bottom: 20px; border: 3px solid #fff; box-shadow: 0 0 15px rgba(255, 255, 255, 0.2); min-width: 300px; }
        .stat-item { font-size: 1.3rem; margin: 5px 0; color: #fff; }
        .coin-text { color: #00ffff; font-weight: bold; text-shadow: 0 0 5px #0000ff; }
        .income-text { color: #00ff00; font-weight: bold; text-shadow: 0 0 5px #006400; }

        /* ìƒì  */
        .shop-container { display: flex; justify-content: center; margin-bottom: 30px; }
        .shop-card { background: linear-gradient(135deg, #000, #333); border: 4px solid; border-image: linear-gradient(45deg, red, orange, yellow, green, blue, indigo, violet) 1; padding: 20px; width: 280px; cursor: pointer; transition: transform 0.1s; box-shadow: 0 0 30px rgba(255,255,255,0.2); position: relative; }
        .shop-card:active { transform: scale(0.95); }
        .shop-title { font-size: 1.8rem; font-weight: 900; margin-bottom: 8px; background: -webkit-linear-gradient(#eee, #333); -webkit-background-clip: text; }
        .shop-price { font-size: 1.4rem; color: #ffd700; font-weight: bold; margin-bottom: 8px; }
        .shop-desc { font-size: 0.9rem; color: #aaa; line-height: 1.4; }

        /* ë©”ì‹œì§€ */
        #messageArea { height: 35px; font-size: 1.3rem; font-weight: bold; margin-bottom: 15px; text-shadow: 2px 2px 4px black; }

        /* ì¸ë²¤í† ë¦¬ */
        #inventory { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; padding: 10px; min-height: 200px; }
        .pet-card { background-color: #2a2a2a; border-radius: 15px; width: 140px; padding: 8px; text-align: center; box-shadow: 0 4px 8px rgba(0,0,0,0.3); animation: popIn 0.4s ease-out; display: flex; flex-direction: column; align-items: center; position: relative; border: 2px solid transparent; }
        .img-wrapper { position: relative; width: 90px; height: 90px; margin-bottom: 5px; background: rgba(0,0,0,0.2); border-radius: 10px; overflow: hidden; }
        .pet-img { width: 100%; height: 100%; object-fit: contain; filter: drop-shadow(0 0 5px rgba(255,255,255,0.2)); transition: filter 0.3s; }
        .pet-name { font-weight: bold; font-size: 0.8rem; margin-bottom: 4px; color: #fff; min-height: 2.5em; display: flex; align-items: center; justify-content: center; word-break: keep-all; line-height: 1.2;}
        .pet-stat { font-size: 0.8rem; color: #00ff00; font-weight: bold; background: rgba(0,0,0,0.6); padding: 2px 5px; border-radius: 5px; margin-bottom: 6px;}
        .pet-level { position: absolute; top: 5px; right: 5px; background: #ff0000; color: white; font-size: 0.7rem; font-weight: bold; padding: 2px 6px; border-radius: 10px; box-shadow: 0 0 5px black; }
        .pet-rarity-badge { font-size: 0.65rem; color: #aaa; margin-bottom: 2px; text-transform: uppercase; letter-spacing: 1px; }
        .btn-sell { background-color: #d9534f; color: white; border: none; padding: 4px 8px; border-radius: 5px; cursor: pointer; font-size: 0.75rem; width: 100%; margin-top: auto; }

        /* í°ìƒ‰ ë°°ê²½ ì œê±° (Multiply íš¨ê³¼) */
        .remove-white-bg { mix-blend-mode: multiply; }

        /* í« ë“±ê¸‰ ìŠ¤íƒ€ì¼ */
        .common { border-color: #b0b0b0; } 
        .rare { border-color: #00bfff; box-shadow: 0 0 5px #00bfff; } 
        .epic { border-color: #d000ff; box-shadow: 0 0 8px #d000ff; }
        .legendary { border-color: #ffcc00; box-shadow: 0 0 15px #ffcc00; animation: glow 2s infinite; }
        .secret { border: 4px solid transparent !important; border-image: linear-gradient(to bottom, #000 0%, #fff 50%, #000 100%) 1 !important; box-shadow: 0 0 15px rgba(255, 255, 255, 0.5) !important; }
        .mythical, .god { border: 3px solid #00ffff; background: linear-gradient(180deg, #001a1a, #003333); box-shadow: 0 0 25px #00ffff; animation: mythicalGlow 1.5s infinite alternate; }
        .og { border: 4px solid transparent !important; border-image: linear-gradient(180deg, #f7e500 0%, #C9BA00 25%, #988D00 50%, #716900 75%, #000 100%) 1 !important; box-shadow: 0 0 20px #f7e500 !important; animation: ogPulse 2s infinite alternate; }

        /* í•©ì„±(í“¨ì „) ë ˆë²¨ ìŠ¤íƒ€ì¼ ë° ìºë¦­í„° ìƒ‰ìƒ ë³€ì¡° */
        
        /* Lv2: ë…¸ë‘ (Yellow) */
        .fusion-2 { border-color: #FFFF00 !important; box-shadow: 0 0 10px #FFFF00 !important; }
        .fusion-2 .pet-img { filter: sepia(1) saturate(10) hue-rotate(0deg) !important; }

        /* Lv3: í•˜ëŠ˜ (Sky Blue) */
        .fusion-3 { border-color: #87CEEB !important; box-shadow: 0 0 12px #87CEEB !important; }
        .fusion-3 .pet-img { filter: hue-rotate(180deg) brightness(1.2) !important; }

        /* Lv4: ë¬´ì§€ê°œ (Rainbow) - ìƒ‰ìƒ ë³€ì¡°ëŠ” ì• ë‹ˆë©”ì´ì…˜ìœ¼ë¡œ */
        .fusion-4 { border: 3px solid transparent !important; background-image: linear-gradient(#2a2a2a, #2a2a2a), linear-gradient(45deg, red, orange, yellow, green, blue, indigo, violet); background-origin: border-box; background-clip: content-box, border-box; box-shadow: 0 0 15px rgba(255,255,255,0.5); animation: rainbowBorder 3s infinite linear; }
        .fusion-4 .pet-img { animation: rainbowFilter 3s infinite linear; }

        /* Lv5: ìš©ì•” (Lava/Red) */
        .fusion-5 { border-color: #CF1020 !important; box-shadow: 0 0 20px #CF1020, inset 0 0 10px #CF1020 !important; animation: glowRed 1s infinite alternate; }
        .fusion-5 .pet-img { filter: sepia(1) saturate(5) hue-rotate(-50deg) contrast(1.2) !important; }

        /* Lv6: ë³´ë¼ (Purple) */
        .fusion-6 { border-color: #800080 !important; box-shadow: 0 0 15px #800080 !important; }
        .fusion-6 .pet-img { filter: hue-rotate(260deg) saturate(1.5) !important; }

        /* Lv7: ë°©ì‚¬ëŠ¥ (Neon Green) */
        .fusion-7 { border-color: #39FF14 !important; box-shadow: 0 0 20px #39FF14 !important; animation: pulseGreen 0.5s infinite; }
        .fusion-7 .pet-img { filter: hue-rotate(90deg) saturate(3) brightness(1.2) !important; }

        /* Lv8: ìº”ë”” (Pink) */
        .fusion-8 { border-color: #FFC0CB !important; box-shadow: 0 0 15px #FF69B4 !important; background: repeating-linear-gradient(45deg, #2a2a2a, #2a2a2a 10px, #3a2a2a 10px, #3a2a2a 20px); }
        .fusion-8 .pet-img { filter: hue-rotate(300deg) saturate(1.5) !important; }

        /* Lv9: ë¸”ëŸ¬ë“œ (Dark Red) */
        .fusion-9 { border-color: #880000 !important; box-shadow: 0 0 25px #ff0000 !important; background: #200; }
        .fusion-9 .pet-img { filter: sepia(1) saturate(5) hue-rotate(-50deg) brightness(0.6) !important; }

        /* Lv10: ìŒì–‘ (Black & White) */
        .fusion-10 { border: 4px double #fff !important; outline: 2px solid #000; box-shadow: 0 0 30px #fff, inset 0 0 20px #000 !important; animation: yinyangSpin 5s infinite linear; }
        .fusion-10 .pet-img { filter: grayscale(1) contrast(2) brightness(1.2) !important; }

        @keyframes popIn { 0% { transform: scale(0); } 100% { transform: scale(1); } }
        @keyframes glow { 0%, 100% { box-shadow: 0 0 10px #ffcc00; } 50% { box-shadow: 0 0 25px #ffff00; } }
        @keyframes mythicalGlow { 0% { box-shadow: 0 0 15px #00ffff; transform: translateY(0); } 100% { box-shadow: 0 0 40px #00ffff; transform: translateY(-3px); } }
        @keyframes ogPulse { from { box-shadow: 0 0 15px #f7e500; } to { box-shadow: 0 0 35px #f7e500; } }
        @keyframes rainbowBorder { 0% { filter: hue-rotate(0deg); } 100% { filter: hue-rotate(360deg); } }
        @keyframes rainbowFilter { 0% { filter: hue-rotate(0deg); } 100% { filter: hue-rotate(360deg); } }
        @keyframes glowRed { from { box-shadow: 0 0 10px #CF1020; } to { box-shadow: 0 0 25px #FF4500; } }
        @keyframes pulseGreen { 0% { box-shadow: 0 0 10px #39FF14; } 50% { box-shadow: 0 0 25px #39FF14; } 100% { box-shadow: 0 0 10px #39FF14; } }
        
        #saveToast { visibility: hidden; min-width: 250px; margin-left: -125px; background-color: #333; color: #fff; text-align: center; border-radius: 2px; padding: 16px; position: fixed; z-index: 3000; left: 50%; bottom: 30px; font-size: 17px; border: 1px solid #00ff00; }
        #saveToast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
        @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }
    </style>
</head>
<body class="pc-mode">

    <div id="saveToast">ğŸ’¾ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤! (Saved)</div>
    
    <!-- í–‰ìš´ ìƒíƒœì°½ -->
    <div id="luckStatus">ğŸ€ Luck x1.0 (0s)</div>

    <button class="btn-settings-open" onclick="openSettings()">âš™ï¸ ì„¤ì •</button>

    <!-- ì„¤ì • ëª¨ë‹¬ -->
    <div id="settingsModal">
        <div class="settings-content">
            <div class="settings-title">SETTINGS</div>
            
            <div class="settings-section">
                <span class="settings-label">Redeem Code (ë³´ìƒ ì½”ë“œ)</span>
                <div class="code-input-group">
                    <input type="text" id="codeInput" placeholder="Code here...">
                    <button id="btnRedeem" onclick="redeemCode()">ì…ë ¥</button>
                </div>
            </div>

            <div class="settings-section">
                <span class="settings-label">Background Color</span>
                <div class="btn-group">
                    <button class="color-btn" style="background:#000;" onclick="setBg('black')"></button>
                    <button class="color-btn" style="background:#fff;" onclick="setBg('white')"></button>
                    <button class="color-btn" style="background:#006400;" onclick="setBg('green')"></button>
                    <button class="color-btn" style="background:#00008b;" onclick="setBg('blue')"></button>
                    <button class="color-btn" style="background:#8b0000;" onclick="setBg('red')"></button>
                    <button class="color-btn" style="background:#ff69b4;" onclick="setBg('pink')"></button>
                </div>
            </div>

            <div class="settings-section">
                <span class="settings-label">Special Themes</span>
                <button id="btnBgSecret" class="special-bg-btn" onclick="setBg('secret')">ğŸ”³ Secret Theme (Locked)</button>
                <button id="btnBgOg" class="special-bg-btn" onclick="setBg('og')">ğŸ‘‘ OG Theme (Locked)</button>
                <button id="btnBgRainbow" class="special-bg-btn" onclick="setBg('rainbow')">ğŸŒˆ Rainbow Theme (Locked)</button>
            </div>

            <div class="settings-section">
                <span class="settings-label">Screen Mode</span>
                <div class="btn-group">
                    <button class="setting-btn active" id="btnModePC" onclick="setPlatform('pc')">PC</button>
                    <button class="setting-btn" id="btnModeMobile" onclick="setPlatform('mobile')">Mobile</button>
                </div>
            </div>

            <div class="settings-section">
                <div class="btn-group">
                    <button class="btn-save" onclick="saveGame(true)">ğŸ’¾ ì €ì¥ (Save)</button>
                    <button class="btn-reset" onclick="resetGame()">ğŸ—‘ï¸ ì´ˆê¸°í™” (Reset)</button>
                </div>
            </div>

            <!-- í•µ ë²„íŠ¼ ì‚­ì œë¨ -->

            <button class="btn-close" onclick="closeSettings()">ë‹«ê¸°</button>
        </div>
    </div>

    <!-- ë¦¬ë©”ì´í¬ëœ í•´í‚¹ ë©”ë‰´ -->
    <div id="hackMenu">
        <div class="hack-header">
            <span>SYSTEM_OVERRIDE_V33</span>
            <span class="hack-close" onclick="closeHackMenu()">[âœ–]</span>
        </div>
        <div class="hack-body">
            <div class="hack-row">
                <label class="hack-label">TARGET_PET_ID:</label>
                <select id="hackPetSelect" class="hack-select"></select>
            </div>
            <button class="hack-btn" onclick="hackSpawnCustom()">[ EXECUTE SPAWN ]</button>
            <button class="hack-btn" onclick="hackAddMoney(1000000000000000)">[ INJECT 1.0Q COINS ]</button>
            <button class="hack-btn" onclick="activateLuck(100, 600)">[ BOOST LUCK_x100 ]</button>
        </div>
    </div>

    <!-- ì œëª© í´ë¦­ 4ë²ˆ í•˜ë©´ í•´í‚¹ ë©”ë‰´ ì˜¤í”ˆ (ìˆ˜ì •ë¨) -->
    <h1 id="gameTitle" onclick="triggerSecret()">ğŸ§  ë¸Œë ˆì¸ë¡¯ í›”ì¹˜ê¸° V33</h1>

    <div class="control-panel">
        <button id="btnAutoGacha" class="auto-btn off" onclick="toggleAutoGacha()">ğŸ”„ ìë™ ë½‘ê¸°: OFF</button>
        
        <!-- í•©ì„± NPC ë²„íŠ¼ -->
        <div class="fusion-npc-container" onclick="autoFuseAll()">
            <img src="https://i.namu.wiki/i/HJ2Tr0tUwEzlUs3Qt-nWtsTQqZDSJTBazheCaHqcgc9j2Q_t9Qh9VQLlrBtvKA2x6ZdMuLMPxtDC5RClqK9uETzh9cmsC3D1wtQOHxCDrMEhi8y2g7VMInW5nOJqO-YcztjcooswdBQoGddXII5LJQ.webp" class="fusion-npc-img" alt="Fusion NPC">
            <span class="fusion-text">í•©ì„±í•˜ê¸° (CLICK!)</span>
        </div>

        <div class="autosell-container">
            <div style="width:100%; color:#fff; font-size:0.8rem; margin-bottom:3px;">ğŸ—‘ï¸ ìë™ íŒë§¤ (í•©ì„± ì¬ë£Œë„ íŒë§¤ë˜ë‹ˆ ì£¼ì˜!)</div>
            <button class="filter-btn" onclick="toggleAutoSell('common')" id="filter-common">ì¼ë°˜</button>
            <button class="filter-btn" onclick="toggleAutoSell('rare')" id="filter-rare">í¬ê·€</button>
            <button class="filter-btn" onclick="toggleAutoSell('epic')" id="filter-epic">ì—í”½</button>
            <button class="filter-btn" onclick="toggleAutoSell('legendary')" id="filter-legendary">ì „ì„¤</button>
            <button class="filter-btn" onclick="toggleAutoSell('god')" id="filter-god">ê°“</button>
            <button class="filter-btn" onclick="toggleAutoSell('secret')" id="filter-secret">ì‹œí¬ë¦¿</button>
        </div>
    </div>

    <div class="stats-container">
        <div class="stat-item"><span id="txtCoin">ğŸ’° ì½”ì¸:</span> <span id="coinDisplay" class="coin-text">1000</span></div>
        <div class="stat-item"><span id="txtIncome">âš¡ ì´ˆë‹¹ ìˆ˜ì…:</span> <span id="cpsDisplay" class="income-text">0</span></div>
    </div>

    <div class="shop-container">
        <div class="shop-card" onclick="buyGacha()">
            <div class="shop-title">ğŸŒŒ ULTIMATE BOX</div>
            <div class="shop-price"><span id="gachaPrice">200</span> Coin</div>
            <div class="shop-desc">
                ëª¨ë“  í«ì´ ë‚˜ì˜¤ëŠ” ìœ ì¼í•œ ìƒì<br>
                êµ¬ë§¤ ì‹œ ê°€ê²© 2ë°° (Max 10ì–µ)<br>
                <span style="color:#00ff00; font-size:0.8rem;">(í–‰ìš´ ë¬¼ì•½ ì ìš©ë¨)</span>
            </div>
        </div>
    </div>

    <div id="messageArea"></div>

    <h2 id="txtInventory">ğŸ’ ì¸ë²¤í† ë¦¬ (í•©ì„±: NPC í´ë¦­)</h2>
    <div id="inventory"></div>

    <script>
        // --- ë³€ìˆ˜ ë° ì„¤ì • ---
        let coins = 1000;
        let incomePerSecond = 0;
        let myPets = [];
        let isAutoGacha = false;
        let autoGachaInterval = null;
        let autoSellFilters = { common: false, rare: false, epic: false, legendary: false, god: false, secret: false };
        let gachaCost = 200;
        const maxGachaCost = 1000000000;
        let currentBg = 'black';
        let luckMultiplier = 1;
        let luckEndTime = 0;
        let usedCodes = [];

        // ì‹œí¬ë¦¿ ë©”ë‰´ íŠ¸ë¦¬ê±°ìš© ë³€ìˆ˜
        let secretClicks = 0;
        let secretResetTimer = null;

        // í« ë°ì´í„°
        const allPets = [
            // OG
            { name: "ì„¸ë¯¸", income: 1000000000000, rarity: "OG", class: "og", sellPrice: 500000000000, img: "https://i.namu.wiki/i/gfAt2lBAxpzdA9X1cBmYDz_4F2xF14FFMrVBZkH5avIvKz4zOxhvVCzjswVLO8DSn-U3rRzP9EeWRXuTF8nEHA.webp", chance: 0.001 },
            { name: "ì˜ë¸ë¦¬ ë¼ì¿ ë‹ˆë‹ˆ", income: 390000000, rarity: "OG", class: "og", sellPrice: 195000000, img: "https://i.namu.wiki/i/VDXijsgXo7gSLYBQtbYlhG1aKSjOE9uFMfJP0Zdo6yB2hQy-eb5gurjhbiqurj4yDr3JG03SQHTXUZ9HLSs8ZrsuUS-TIjcyPnFSDLf5DVEBrSAIrg2xQGa5YQQuQLBLOrkN-dy9XT1oEDatabQSBg.webp", chance: 0.003 },
            { name: "ê²ŒìŠ¤íŠ¸ 666", income: 666600000, rarity: "OG", class: "og", sellPrice: 333300000, img: "https://i.namu.wiki/i/UU_Db9xY3wiuZBJAHl3qQ6R_jszkWWcvnYJ9eYgoN9bmwR8s4fl2-L9hGcJYXsMCrJJetK3kX9AgOjEB9penRJNnFDMvaXVIQm43tJLaTGt-NBlVWYc9ZjLnf_XWo6Mf92JBW-SDfCxTPMy6L85FUQ.webp", chance: 0.005 },
            { name: "ìŠ¤íŠ¸ë£¨ ë°°ë¦¬ ì—˜ë¦¬ í€íŠ¸", income: 550000000, rarity: "OG", class: "og", sellPrice: 200000000, img: "https://i.namu.wiki/i/6TSF60r7sy5c4ygq8oXq20smrQb_FtqRx6JHsZreJAE25VRxWZSBcfZE9OK2AwKQgy7UXReBUzb9-Rwnls8-JVodj195mqWlXCCGf42j3Iu4Tt1DolDLORXfkolpZzcneWOtaagqYkvv38pzAKhN3A.webp", chance: 0.01 },
            
            // Secret
            { name: "ë“œë˜ê³¤ ì¹´ë©œë¡œë‹ˆ", income: 250000000, rarity: "ì‹œí¬ë¦¿", class: "secret", sellPrice: 80000000, img: "https://i.namu.wiki/i/Q2vCmM_9Lzgu3MoLwiOcjd64PwHnplpRqqd6I4LPnXPEyNDzNMPvY-DPykfNN_tE79kldLVspE85fxbnRQLOkBVGdqlCv6AT_7cmAGCTHLeSaMkSEz4U34GxBveUt1MtNNMQTlwzEemmFEzhd7WxEw.webp", chance: 0.03 },
            { name: "ì¿ í‚¤ì•¤ ë°€í¬", income: 155000000, rarity: "ì‹œí¬ë¦¿", class: "secret", sellPrice: 4500000, img: "https://i.namu.wiki/i/gswQvd_rbb4c2WSINcITXZjHWX_S0fA1I1uSkBE_65z17bGIieLZL0jqhg127BxcxS3oZxbUH4uozaVoPhhCcd8O02bBnP88ELpZqsFfzo7hkx-7XW_mRInMVHwCwNg3bkzRYHSxxotxpe08xtLJVg.webp", chance: 0.04 },
            { name: "ì˜¤ë¥´ì¹¼ë˜ëˆ", income: 40000000, rarity: "ì‹œí¬ë¦¿", class: "secret", sellPrice: 10000000, img: "https://i.namu.wiki/i/eOOd6a50BgkRk8QELPGSWzf7tvATkMs84NJzArCnZDukmFdE-lhOiOjkYLFnAdYBBEyuCWEm7l2vkwspLvguD69HC9tRaMr77gqlF0s-NuPuYkKsEq-a3vqU21y2vAo8s0jUzu846cL2S6mIi_AHqg.webp", chance: 0.09 },
            
            // New V33 Pets
            { name: "ë¡œìŠ¤ ë¸Œë¡œìŠ¤", income: 24000000, rarity: "ì‹œí¬ë¦¿", class: "secret", sellPrice: 6000000, img: "https://i.namu.wiki/i/QAVbn3pRnLeMC3xSdgVRgoxrft9LyMTIMxLKIgW-HRmMyN3egtDvyv4P_5ZMOdhZyxQmfoU-N-Kx_QHyLzCvic_qLtClKjQVKYr9OTrbZVTPrSxWjfFMQeO8p8Y-jODlU32EzwxXQvulIGOl_YAsWQ.webp", chance: 0.15 },
            { name: "ë¡œìŠ¤ ëª¨ë¹Œë¦¬ìŠ¤", income: 22200000, rarity: "ì‹œí¬ë¦¿", class: "secret", sellPrice: 5500000, img: "https://i.namu.wiki/i/v8N378-9peOV2NX1uuMrYCnc6BAnu_j0oiuwNT99pDOnT3gFiPzMyvD2hPRs98bCTIK2qNZE6YSnBMbB6lbYxqRkQlCtMAP7vASDYBppOwo_diyaQasAYuacAzbCFuKOwtnjPcShmtv_qnmdxrjbJg.webp", chance: 0.23 },
            { name: "ë¡œìŠ¤ í”„ë¦¬ëª¨ìŠ¤", income: 19000000, rarity: "ì‹œí¬ë¦¿", class: "secret", sellPrice: 4500000, img: "https://i.namu.wiki/i/Xo3mhwst7nQQZbHzcenCWaNRHy9mAnM9bRWUh9Yatl0-Qt_ZXhqKB1Nus_5gxz5JaX2k1o3uz4LeFE29fyfZd9B71tsoYpfpquVGHOo7jhjt3pRZzXMlxpF5mfhyoc4CIvbXDXQozSh2cjTMpI45pA.webp", chance: 0.2 },
            { name: "ë¼ìŠ¤ ì‹œìŠ¤", income: 17500000, rarity: "ì‹œí¬ë¦¿", class: "secret", sellPrice: 4300000, img: "https://i.namu.wiki/i/sIzyrjPyp3BK-y-zhoJXzl3tQC6ok6yrhSzE4g2Xa7nQfSWmkm0QkdKgyDe_9voVlnXTbbmyulqyjIGiL4J8r4ZjyGoW0hrUWgffyZAp07WAUcN9zsb6zFeSnWXeOxQqru7cXFqURgptGQgF52zC_Q.webp", chance: 0.22 },

            { name: "ì„¸ë¡¤ë¼ ì‹œë‹ˆ ë¹„ë””ì˜¤ ì‹œë‹ˆ", income: 22500000, rarity: "ì‹œí¬ë¦¿", class: "secret", sellPrice: 5500000, img: "https://i.namu.wiki/i/SLOUZZ3Y0hNgLQgEcsbQh7L_lW0BYsQOUx4KU1wAzIGy1cp2m9-_XfRVrZGoh10CecmbUmdR64hLZr9EInHoYMvTnlj0cYuTogXOsi8r2JBPwG6hjzFXlmGD5eGxeRc8cPQhrJiqCUGb7sU5H2g_MA.webp", chance: 0.25 },
            { name: "ë¡œìŠ¤ ì½¤ë¹„ë„¤ì´ì…˜", income: 15000000, rarity: "ì‹œí¬ë¦¿", class: "secret", sellPrice: 3000000, img: "https://i.namu.wiki/i/SGGTNguEujJLT8gihof8x8G_UwttE0isPHqrskIOffbfYaawxJIaIVp-bjTRqBsHgx5RZceDQEfMXgTegmXepXVVh8MWYeGle3K0dIeIgK5yulVO3-XpTWb7MGaQ0FKeFqr992s96YAaT_xwRB4Y7Q.webp", chance: 0.4 },
            { name: "ë¼ê·¸ë€ëŒ€ ì½¤ë¹„ë„¤ì´ì…˜", income: 10000000, rarity: "ì‹œí¬ë¦¿", class: "secret", sellPrice: 2000000, img: "https://i.namu.wiki/i/wrYcFme78_yGYn07s7NeKMx5xA8rhAm3P3qW7MnGSzccjOOn6dx4t73WLWtIljEVk8kMiuGieLvl4LuTh_WHXjPqi8VXqKv3SZnNJm9j0uRjSl3bWIXu8TU8kfPXWAwDIysoVvnwe2rURNFlF6cHRA.webp", chance: 1.0 },
            { name: "ë¡œìŠ¤ ë¶€ë¦¬ë˜", income: 8500000, rarity: "ì‹œí¬ë¦¿", class: "secret", sellPrice: 1700000, img: "https://i.namu.wiki/i/zivuDz8g5NHr6OQO-gLKM43rScb1WlNnBA9YUjKq_AgV0xGbVT1n7w419yfPzlVH-F7uJ_aGi336qu1QOx8G1DBrg6tWBQHn0HYsyhouBj8VgS9w5OFdRo9wTt1C9G9-Tl4BMhJAW3PprtBIM6Pipw.webp", chance: 1.2 },
            
            // God & New Secrets
            { name: "ì¿ ì•„ë“œë¼ë§› ê³¼ íŒŒí¬ë¼ë§›", income: 2700000, rarity: "ê°“(GOD)", class: "god", sellPrice: 650000, img: "https://i.namu.wiki/i/gmNsW_Kq9Jpkuf4Ao5u7GRi2_YDhSe9YXIHTsomAN7oJ4bp7q_EzrVKgorNSV3q_b77ncxCP5GG-qdpVjL3Ox9sWqQwxtmXsc1CPtmY1pzQY8UdgMM10jdS7PJ5KMj8dysPV2zAK7itCDhiSouc9Vg.webp", chance: 1.8, specialStyle: "remove-white-bg" },
            { name: "ë…¸ì˜¤ì˜¤ ë§ˆì´ í”Œë¦¬ì¦ˆë§ˆ", income: 425000, rarity: "ê°“", class: "god", sellPrice: 100000, img: "https://i.namu.wiki/i/U1fQ75127ymk_dj6KE-QkHxhE0fqS7MYrnLuJnss3U0wN6M1f7NA_Sbn77JCOu7mteNkAT3Tiq36GmrxNjXgacJbgJzh2JvmOzD7mOOGVg5BzXrxeHTow-NMqiFVM1jzTFE_6Xu29y_Ek5UnqSJQOQ.webp", chance: 3.5 },
            
            // Etc
            { name: "ë¸”ë™í™€ ê³ íŠ¸", income: 400000, rarity: "ì´ˆí¬ê·€", class: "epic", sellPrice: 80000, img: "https://i.namu.wiki/i/G11clqIbv5U99KQZ_vc7OLWPEREhLq9-s-OmHOvosFEc6nhuKrRnVeoAtTMdMKbvBRgmJzTz8J9owHzB6MYNVY8LWGpCMZi85N0b0mgwZ37ZhRjYEPbamAYCDT4GpIVl_1R44n0euT4xzIDp0Nn8nQ.webp", chance: 4.0 },
            { name: "ë¨¸ë‹ˆë¨¸ë‹ˆ ë§¨", income: 65000, rarity: "ì „ì„¤", class: "legendary", sellPrice: 15000, img: "https://i.namu.wiki/i/rm5KkVvLrLjR8v8ShZiLEAnb21gofjfDM4Ua2q715qcJpAWVEQ2ZIpx4oW16Z-9lUIr5mloVabgj4xLJrJShKd53P46u1TJUCafvRz43zdQkzF0VJddbHQC2sgysyGBCwRH41LOodYEL7I-A7cwB0Q.webp", chance: 4.5 },
            { name: "ë¡œìŠ¤ ì˜¤ë¥¼ì¹¼ ë¦¬í† ìŠ¤", income: 900, rarity: "ì „ì„¤", class: "legendary", sellPrice: 2500, img: "https://i.namu.wiki/i/DlnbwotDMs9lFz0r4eyGrDsHitXFdCptrmNbQFv6ZoRZ3iCy1ETST_WM3mXLwKNJRpxpRuVo6RAh_psl88pfBmBWwalSDEyYKh3TpwQJsZY3Z2xwOVimdDdCBpAWbaayz4jA4dbo1i4ndCpr7HxgRA.webp", chance: 5.0 },
            { name: "í„°ë³´ 3000", income: 200, rarity: "í¬ê·€", class: "rare", sellPrice: 500, img: "https://i.namu.wiki/i/UrhZ3POgmnWPlmiX6CA1TYjePe9UDIdAaIGwJXeLDPXSzAaWpOUXEQiIX9mWiLsezbR7sVgCc5fFD9L3gCT8QU9Ty_xwRjEsoKh6fmwu218P5OyZ-Y1QfZwPfabIkP4jJpTqYyhbdEhvemIhHQLl5A.webp", chance: 9.0 },
            { name: "í”¼í”¼ í‚¤ìœ„", income: 12, rarity: "ì´ˆí¬ê·€", class: "epic", sellPrice: 6, img: "https://i.namu.wiki/i/zDv0SzOJaSqbDLXDx8vsQDvcbcF3luF6k00VT9NNBfCzkAc-HgwgTDNmNedAbt92s16M0YwwDEq7RuM6EzI9njrC8xEklirxEeqEYlsKMMWeBjTNIEE4LXzLOK3dU7dpkVFXD0HPZSeLyqRJAgVVBA.webp", chance: 11.0 },
            { name: "í”„ë¡¤ë¦¬ í”„ë¡¤ë¼", income: 7, rarity: "ì¼ë°˜", class: "common", sellPrice: 3, img: "https://i.namu.wiki/i/Bnsp0t-AH32xHo_07o896ZpMjFL_Nqy7NUkm6OdDx_Esp3SppQNYTVnvR6ZPQm-n-F8IiAwmDgJbSo4pH2jZbrbzlQivTTM6XOii_CQXCK6zMJwro1cmpDjwhWlFkuUy3Uqz9GPNrEHfg1eMPhiCwg.webp", chance: 15.0 },
            { name: "íŒ€ ì¹˜ì¦ˆ", income: 5, rarity: "ì¼ë°˜", class: "common", sellPrice: 2, img: "https://i.namu.wiki/i/GSd6Tw8GxlFT3f1hPBc64RIF_rjpIkp-Czm3tmgxpXjM1YlS1cqTPXjJggbVcEI_Rt-FwuQTVVo5Q5ZA5Bbqr01hqGo-9xce6CWumCjMTdvLn9XvAy_aUeUcxXHV5b4Z5z-R89MOKWQxI1D3kE0EaA.webp", chance: 17.58 }
        ];

        const coinDisplay = document.getElementById('coinDisplay');
        const cpsDisplay = document.getElementById('cpsDisplay');
        const inventoryDiv = document.getElementById('inventory');
        const settingsModal = document.getElementById('settingsModal');
        const btnBgSecret = document.getElementById('btnBgSecret');
        const btnBgOg = document.getElementById('btnBgOg');
        const btnBgRainbow = document.getElementById('btnBgRainbow');
        const luckStatus = document.getElementById('luckStatus');
        const hackMenu = document.getElementById('hackMenu');
        
        const gachaPriceDisplay = document.getElementById('gachaPrice');

        // --- ì´ˆê¸°í™” ë° ë¡œë“œ ---
        function loadGame() {
            const saved = localStorage.getItem('brainrotSaveV33');
            if (saved) {
                const data = JSON.parse(saved);
                coins = data.coins || 1000;
                myPets = data.pets || [];
                gachaCost = data.cost || 200;
                autoSellFilters = data.filters || {};
                currentBg = data.bg || 'black';
                usedCodes = data.usedCodes || [];
                
                myPets.forEach(p => { if(!p.level) p.level = 1; });

                if (data.luckEndTime && data.luckEndTime > Date.now()) {
                    activateLuck(data.luckMultiplier, (data.luckEndTime - Date.now()) / 1000);
                }
                
                setBg(currentBg);
                renderInventory();
                updateDisplay();
                updateIncome();
                
                for(const [k, v] of Object.entries(autoSellFilters)){
                    const btn = document.getElementById(`filter-${k}`);
                    if(btn && v) btn.classList.add('active');
                }
            }
        }

        function saveGame(showToast = false) {
            const saveData = {
                coins: coins,
                pets: myPets,
                filters: autoSellFilters,
                cost: gachaCost,
                bg: currentBg,
                usedCodes: usedCodes,
                luckMultiplier: luckMultiplier,
                luckEndTime: luckEndTime
            };
            localStorage.setItem('brainrotSaveV33', JSON.stringify(saveData));
            if(showToast) {
                const t = document.getElementById('saveToast');
                t.className = "show";
                setTimeout(() => { t.className = t.className.replace("show", ""); }, 3000);
            }
        }

        function resetGame() {
            if(confirm("ì •ë§ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤)")) {
                localStorage.removeItem('brainrotSaveV33');
                location.reload();
            }
        }

        // --- ì‹œí¬ë¦¿ í•´í‚¹ ë©”ë‰´ ë¡œì§ (ìˆ˜ì •ë¨: 4ë²ˆ í´ë¦­) ---
        function triggerSecret() {
            secretClicks++;
            clearTimeout(secretResetTimer);
            secretResetTimer = setTimeout(() => { secretClicks = 0; }, 1000);
            
            // 4ë²ˆ í´ë¦­í•˜ë©´ ì˜¤í”ˆ
            if(secretClicks >= 4) {
                openHackMenu();
                secretClicks = 0;
            }
        }

        // í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ ("í•µ" ì…ë ¥ ì‹œ)
        window.addEventListener('keyup', (e) => {
            if (e.key === 'í•µ') {
                openHackMenu();
            }
        });

        function openHackMenu() {
            closeSettings();
            hackMenu.style.display = "block";
            populateHackSelect();
        }

        function closeHackMenu() { hackMenu.style.display = "none"; }

        // --- ì½”ë“œ ì‹œìŠ¤í…œ ---
        function redeemCode() {
            const input = document.getElementById('codeInput');
            const code = input.value.trim();

            if (usedCodes.includes(code)) {
                alert("ì´ë¯¸ ì‚¬ìš©ëœ ì½”ë“œì…ë‹ˆë‹¤!"); return;
            }

            if (code === "gg100k") {
                coins += 30000;
                alert("ë³´ìƒ ì§€ê¸‰: 30,000 ì½”ì¸!");
                usedCodes.push(code); saveGame(); updateDisplay();
            } else if (code === "hhh") {
                activateLuck(10, 120);
                alert("ë³´ìƒ ì§€ê¸‰: 10ë°° í–‰ìš´ í¬ì…˜ (2ë¶„)!");
                usedCodes.push(code); saveGame();
            } else {
                alert("ìœ íš¨í•˜ì§€ ì•Šì€ ì½”ë“œì…ë‹ˆë‹¤.");
            }
            input.value = "";
        }

        // --- í–‰ìš´ ì‹œìŠ¤í…œ ---
        function activateLuck(multiplier, durationSeconds) {
            luckMultiplier = multiplier;
            luckEndTime = Date.now() + (durationSeconds * 1000);
            updateLuckDisplay();
        }

        function updateLuckDisplay() {
            const remaining = luckEndTime - Date.now();
            if (remaining > 0) {
                luckStatus.style.display = "block";
                luckStatus.innerText = `ğŸ€ Luck x${luckMultiplier} (${Math.ceil(remaining/1000)}s)`;
                requestAnimationFrame(updateLuckDisplay);
            } else {
                luckMultiplier = 1;
                luckStatus.style.display = "none";
            }
        }

        // --- ê²Œì„ ë¡œì§ ---
        function setBg(color) {
            currentBg = color;
            document.body.className = document.body.className.replace(/bg-\w+/g, '').trim(); 
            const mode = document.getElementById('btnModePC').classList.contains('active') ? 'pc-mode' : 'mobile-mode';
            
            if (['secret', 'og', 'rainbow'].includes(color)) {
                document.body.className = `${mode} bg-${color}`;
                document.body.style.backgroundColor = '';
                document.body.style.color = (color === 'secret') ? '#00ff00' : 'white';
            } else {
                document.body.className = mode;
                document.body.style.backgroundColor = color;
                document.body.style.color = (color === 'white') ? 'black' : 'white';
            }
        }
        
        function setPlatform(mode) {
            document.getElementById('btnModePC').classList.remove('active');
            document.getElementById('btnModeMobile').classList.remove('active');
            if(mode === 'pc') document.getElementById('btnModePC').classList.add('active');
            else document.getElementById('btnModeMobile').classList.add('active');
            setBg(currentBg); 
        }

        function openSettings() {
            const secretCount = myPets.filter(p => p.class === 'secret').length;
            const ogCount = myPets.filter(p => p.class === 'og').length;
            const godCount = myPets.filter(p => p.class === 'god' || p.class === 'mythical').length;

            updateUnlockBtn(btnBgOg, ogCount, 10, "ğŸ‘‘ OG Theme");
            updateUnlockBtn(btnBgSecret, secretCount, 50, "ğŸ”³ Secret Theme");
            updateUnlockBtn(btnBgRainbow, godCount, 100, "ğŸŒˆ Rainbow Theme");

            settingsModal.style.display = "flex";
        }

        function updateUnlockBtn(btn, current, target, text) {
            if(current >= target) {
                btn.disabled = false; btn.innerText = `${text} (Unlocked)`; btn.classList.add('unlocked');
            } else {
                btn.disabled = true; btn.innerText = `${text} (${current}/${target})`; btn.classList.remove('unlocked');
            }
        }
        
        function closeSettings() { settingsModal.style.display = "none"; }
        
        function populateHackSelect() {
            const sel = document.getElementById('hackPetSelect');
            sel.innerHTML = "";
            allPets.forEach((p, i) => {
                let opt = document.createElement('option');
                opt.value = i; opt.text = p.name; sel.appendChild(opt);
            });
        }
        function hackSpawnCustom() {
            const idx = document.getElementById('hackPetSelect').value;
            let pet = structuredClone(allPets[idx]);
            pet.level = 1;
            myPets.push(pet);
            renderInventory(); updateIncome();
        }
        function hackAddMoney(amt) { coins += amt; updateDisplay(); }

        // --- ë½‘ê¸° ë¡œì§ ---
        function buyGacha(isAuto = false) {
            if (coins < gachaCost) {
                if(isAuto) toggleAutoGacha();
                else alert("ì½”ì¸ì´ ë¶€ì¡±í•©ë‹ˆë‹¤!");
                return;
            }

            coins -= gachaCost;
            if(gachaCost < maxGachaCost) {
                gachaCost *= 2;
                if(gachaCost > maxGachaCost) gachaCost = maxGachaCost;
            }

            let rand = Math.random() * 100;
            let selectedPet = allPets[allPets.length - 1]; 

            let sortedPets = [...allPets].sort((a,b) => a.chance - b.chance);
            let currentStack = 0;

            for (let pet of sortedPets) {
                let effectiveChance = pet.chance * luckMultiplier;
                if (rand <= (currentStack + effectiveChance)) {
                    selectedPet = pet;
                    break;
                }
                currentStack += effectiveChance;
            }

            let newPet = structuredClone(selectedPet);
            newPet.level = 1;

            let rarityKey = getRarityKey(newPet.class);
            
            if (newPet.class === "og") {
                myPets.push(newPet);
                if(!isAuto) showMessage(newPet, false);
            } 
            else if (autoSellFilters[rarityKey]) {
                coins += newPet.sellPrice;
                if(!isAuto) showMessage(newPet, true);
            } 
            else {
                myPets.push(newPet);
                if(!isAuto) showMessage(newPet, false);
            }

            updateDisplay();
            updateIncome();
            if(!isAuto || Math.random() < 0.1) renderInventory();
        }

        function getRarityKey(cls) {
            if(cls === "god" || cls === "mythical") return "god";
            if(cls === "secret" || cls === "og") return "secret";
            return cls;
        }

        function toggleAutoGacha() {
            isAutoGacha = !isAutoGacha;
            const btn = document.getElementById('btnAutoGacha');
            if(isAutoGacha) {
                btn.innerText = "ğŸ”„ ìë™ ë½‘ê¸°: ON"; btn.className = "auto-btn on";
                autoGachaInterval = setInterval(() => buyGacha(true), 100);
            } else {
                btn.innerText = "ğŸ”„ ìë™ ë½‘ê¸°: OFF"; btn.className = "auto-btn off";
                clearInterval(autoGachaInterval);
            }
        }

        function toggleAutoSell(key) {
            autoSellFilters[key] = !autoSellFilters[key];
            const btn = document.getElementById(`filter-${key}`);
            btn.classList.toggle('active');
        }

        // --- í•©ì„±(Fusion) ì‹œìŠ¤í…œ ---
        function autoFuseAll() {
            let groups = {};
            myPets.forEach(p => {
                if(!groups[p.name]) groups[p.name] = [];
                groups[p.name].push(p);
            });

            let fusedCount = 0;
            let newInventory = [];

            for (let name in groups) {
                let pets = groups[name];
                pets.sort((a,b) => a.level - b.level);
                
                let totalValue = 0;
                pets.forEach(p => totalValue += p.level);

                while(totalValue > 0) {
                    let lvl = Math.min(totalValue, 10);
                    let basePet = structuredClone(pets[0]);
                    basePet.level = lvl;
                    newInventory.push(basePet);
                    totalValue -= lvl;
                    fusedCount++;
                }
            }

            if(fusedCount < myPets.length) {
                myPets = newInventory;
                renderInventory();
                updateIncome();
                alert("ğŸ§¬ í•©ì„± ì™„ë£Œ! (ë“±ê¸‰ë³„ ìƒ‰ìƒì´ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤)");
            } else {
                alert("í•©ì„±í•  í«ì´ ì—†ìŠµë‹ˆë‹¤.");
            }
        }

        // --- UI ë° ìœ í‹¸ ---
        function formatNumber(num) {
            if (num >= 10000000000000000) return (num / 10000000000000000).toFixed(2) + "ê²½";
            if (num >= 1000000000000) return (num / 1000000000000).toFixed(2) + "ì¡°";
            if (num >= 100000000) return (num / 100000000).toFixed(2) + "ì–µ";
            if (num >= 10000) return (num / 10000).toFixed(1) + "ë§Œ";
            return num.toLocaleString();
        }

        function updateIncome() {
            incomePerSecond = 0;
            myPets.forEach(p => {
                incomePerSecond += p.income * p.level;
            });
            updateDisplay();
        }

        function updateDisplay() {
            coinDisplay.innerText = formatNumber(coins);
            cpsDisplay.innerText = formatNumber(incomePerSecond);
            if(gachaPriceDisplay) gachaPriceDisplay.innerText = formatNumber(gachaCost);
        }

        function showMessage(pet, sold) {
            const colors = { epic: "#d000ff", legendary: "#ffcc00", secret: "#ccc", god: "#00ffff", og: "#ffd700" };
            const color = colors[pet.class] || "white";
            const msg = sold ? `(ìë™íŒë§¤ +${formatNumber(pet.sellPrice)})` : "íšë“!!!";
            messageArea.innerHTML = `<span style="color:${color}; text-shadow:0 0 10px ${color};">${pet.name}</span> ${msg}`;
            setTimeout(() => messageArea.innerHTML = "", 2000);
        }

        function renderInventory() {
            myPets.sort((a, b) => (b.income * b.level) - (a.income * a.level)); 
            inventoryDiv.innerHTML = "";
            
            myPets.slice(0, 150).forEach((pet, idx) => {
                const div = document.createElement('div');
                
                let fusionClass = "";
                if (pet.level >= 2) fusionClass = `fusion-${pet.level}`;
                
                div.className = `pet-card ${pet.class} ${fusionClass}`;
                
                // íŠ¹ìˆ˜ ìŠ¤íƒ€ì¼ (í°ìƒ‰ ë°°ê²½ ì œê±° ë“±)
                let extraImgClass = pet.specialStyle || "";

                div.innerHTML = `
                    <div class="img-wrapper"><img src="${pet.img}" class="pet-img ${extraImgClass}" onerror="this.src='https://placehold.co/100?text=Pet'"></div>
                    ${pet.level > 1 ? `<div class="pet-level">Lv.${pet.level}</div>` : ''}
                    <div class="pet-rarity-badge">${pet.rarity}</div>
                    <div class="pet-name">${pet.name}</div>
                    <div class="pet-stat">+${formatNumber(pet.income * pet.level)}/s</div>
                    <button class="btn-sell" onclick="sellPet(${idx})">íŒë§¤ (+${formatNumber(pet.sellPrice * pet.level)})</button>
                `;
                inventoryDiv.appendChild(div);
            });
        }

        function sellPet(idx) {
            if(confirm("íŒë§¤í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                let p = myPets[idx];
                coins += p.sellPrice * p.level;
                myPets.splice(idx, 1);
                renderInventory();
                updateIncome();
            }
        }

        setInterval(() => {
            if(incomePerSecond > 0) {
                coins += incomePerSecond;
                updateDisplay();
            }
        }, 1000);
        
        setInterval(() => saveGame(false), 10000); 

        loadGame();
    </script>
</body>
</html>
